{% extends "shop/base.html" %}
{% load static %}

{% block title %}
    {{ product.name }}
{% endblock %}

{% block content %}
    <div class="product-detail">
      <img class="w-25" src="{% if product.image %}{{ product.image.url }}
      {% else %}{% static "img/no_image.png" %}{% endif %}">
      <h1>{{ product.name }}</h1>
      <h2>
          <a href="{{ product.category.get_absolute_url }}">
              {{ product.category }}
          </a>
      </h2>
      <p class="price">Price: {{ product.price }} BYN</p>
      <p class="guarantee">Guarantee: {{ product.guarantee }}</p>
      <form action="{% url "cart:cart_add" product.id %}" method="post">
          {{ cart_product_form }}
          {% csrf_token %}
          <input type="submit" value="Add to cart" class="btn btn-outline-primary">
      </form>
      {{ product.description|linebreaks }}
    </div>
    {% with reviews.count as total_reviews %}
        <h4>
        {{ total_reviews }} review{{ total_reviews|pluralize }}
        </h4>
    {% endwith %}
    {% for review in reviews %}
        <div class="review">
         <p class="info">
             Review {{ forloop.counter }} by {{ review.name }}
             {{ review.created }}
         </p>
         {{ review.body|linebreaks }}
        </div>
    {% empty %}
        <p>There are no reviews yet.</p>
    {% endfor %}

    {% if new_review %}
        <h4>Your review has been added.</h4>
    {% else %}
        <h4>Add new review</h4>
        <form method="post">
        {{ review_form.as_p }}
        {% csrf_token %}
        <p><input type="submit" value="Add review" class="btn btn-primary"></p>
        </form>
    {% endif %}
{% endblock %}